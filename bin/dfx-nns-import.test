#!/usr/bin/env bash
set -euxo pipefail

nns_canisters=(nns-registry nns-governance nns-ledger nns-root nns-cycles-minting nns-lifeline nns-genesis-token nns-identity nns-ui nns-sns-wasm nns-ic-ckbtc-minter internet_identity nns-dapp)
networks=(ic local toy)

(
  echo "dfx-nns-import sets the required values for a local import"
  for network in "${networks[@]}"; do
    dfx-nns-import --network "$network"
    for canister in "${nns_canisters[@]}"; do
      dfx canister id "$canister" >/dev/null || {
        echo "ERROR: Did not import canister ID for $canister"
        exit 1
      }
      [[ "$(c="$canister" jq '.canisters[env.c]')" != "null" ]] || {
        echo "ERROR: Did not import canister ID for $canister"
        exit 1
      }
    done
  done
)
